


# Dancey Dance

This collection of ideas, tools, and thoughts exist to make dance events cheaper and faster to run.
These npm helper scripts run the corresponding functions:

- `npm run commit` — Performs git add / commit / push commands

##### Documentation

- `npm run docs` — hosts the docs locally
- `npm run docs_build` — builds the docs through middleman
- `npm run docs_deploy` — deploys the docs through middleman (github)
- `npm run docs_github` — builds and deploys through middleman (github)
- `npm run docs_stage` — deploys a test site through surge w/ `_test`
- `npm run docs_publish` — deploys a site through surge

##### ATLX

- `npm run atlx`
- `npm run atlx_build`
- `npm run atlx_deploy`
- `npm run atlx_github`
- `npm run atlx_stage`
- `npm run atlx_publish`

##### Interactive / Vue

- `npm run vue`
- `npm run vue_build`
- `npm run vue_local` — also copies files into atlx site js folder

##### Graphcool Server

- `npm run gc_deploy` — redeploys graphcool instance w/ changes


## Documentation

Built with middleman, in the `/docs/` folder.

The documentation site is the design doc and sets the basis for the Dancey Dance dance system. It describes how the system is built and sets the data model and other fundamental details for Dancey Dance.


### Run / Build / Deploy

Middleman is deployed by default to whatever Github is set up as, for github pages. Check the `config.rb` for options. Deploying to Github uses [middleman deploy](https://github.com/middleman-contrib/middleman-deploy).

- Run the npm convenience scripts, as they copy over the latest `readme.md` file into the docs

- `npm run server` — hosts the docs locally
- `npm run build` — builds the docs through middleman
- `npm run deploy` — deploys the docs through middleman (github)
- `npm run github` — builds and deploys through middleman (github)
- `npm run stage` — deploys a test site through surge w/ `_test`
- `npm run publish` — deploys a site through surge


## ATLX Sites 

Or any other dance site. Set up very similar to the Documentation. Static site, with add-on Vue functionality for ticketing, routing, and data-retrieval. Each dance site can be found under `atlx`. Deploy onto a static host like Github Pages or surge.sh.

### Run / Build / Deploy

- `npm run atlx`
- `npm run build`
- `npm run deploy`
- `npm run github`
- `npm run stage`
- `npm run publish`


## Interactivity

The components are built with Vue and add complex interactive capability to the otherwise fully static sites.
These are built in Vue, and the data layer is built on top of GraphQL on the http://graph.cool service. Built as a boilerplate for Vue apps.

##### NPM Addons

- for intercepting JQuery events: https://github.com/nchutchind/vue-outside-events
- https://nchutchind.github.io/vue-outside-events/dist/vue-outside-events.min.js
- vuex — state management: https://vuex.vuejs.org
- sass-loader: https://github.com/webpack-contrib/sass-loader
- data validation: https://github.com/monterail/vuelidate | https://monterail.github.io/vuelidate
- mailgun messaging template https://github.com/graphcool/templates/tree/master/messaging/mailgun
- vuex persisted state: https://github.com/robinvdvleuten/vuex-persistedstate
- pug: http://pugjs.org npm install pug --save-dev
- yarn add graphcool-lib
- vue-paypal-checkout https://github.com/khoanguyen96/vue-paypal-checkout
- krame: markdown/kramdown compiler https://github.com/GitbookIO/kramed


### Run / Build / Deploy

Run and test the app locally, but drop it into a static site generator for testing. Just compile a local version, and add the JS files to the server’s files and watch it run. 

- `npm run dev` — runs it locally
- `npm run build` — builds it for production, to be used on a dynamic server
- `npm run local` — custom; builds a version able to deploy to any static or local site


## GraphCool Data Service

Graphcool provides the backend data service and resolvers / 'lambda' functions.

- https://console.graph.cool/atlx/playground
- graph.cool example db: https://console.graph.cool/react-apollo-tutorial/schema/types
- error on init: https://www.graph.cool/forum/t/migrate-schema-name-options-in-graphcool-init/1514
- install graph cool: npm install -g graphcool | graphcool init server | graphcool playground

In order to use the new CLI, please install it first:
```sh
$ npm install -g graphcool
```

### Project Structure
The central configuration of your upgraded Service lives in the `graphcool.yml`.
There, all your permissions, functions and types are tied together.
You can find your schema in the `types.graphql`.

### Deployment
To deploy changes of your service, just execute
```sh
$ graphcool deploy
```

### Resources
#### CLI
You can read more about the CLI in the [new docs](https://docs-next.graph.cool/reference/graphcool-cli/overview-zboghez5go)
Or execute `graphcool` to see the usage overview.
#### graphcool.yml
The `graphcool.yml` format is described here: https://docs-next.graph.cool/reference/service-definition/graphcool.yml-foatho8aip



### Thoughts

- dynamic routing intercept: https://surge.sh/help/adding-a-200-page-for-client-side-routing
- added a 200.html, and a new new HtmlWebpackPlugin to webpack.prod to build it
- https://surge.sh/help/adding-a-200-page-for-client-side-routing
- https://nchutchind.github.io/vue-outside-events/dist/vue-outside-events.min.js
- added a "local" build for static, local routes / file://
- running from file:// creates Access-Control-Allow-Origin problems; need to be uploaded to at least Github Pages

- https://www.howtographql.com/vue-apollo/1-getting-started
- npm install -g graphcool
- graphcool init --schema https://graphqlbin.com/hn-starter.graphql --name Hackernews
- graphcool playground — runs the playground site
- graphcool endpoints
- graphcool console 
- graphcool deploy — syncs changes
- graphcool list — deployed services
- graphcool status
- graphcool email-password template
  - CLI server directory: (their graphcool-framework is wrong, it's just graphcool)
    graphcool add-template graphcool/templates/auth/email-password
- graphcool local pull — get changes from server; really should just make them locally and `deploy`
- permissions example
  https://www.graph.cool/docs/reference/service-definition/graphcool.yml-foatho8aip/
- tracking functions: graphcool logs -f 'getPasses' --tail


## Other

- Github RSA key reminder: `ssh-add ~/.ssh/github_rsa2`
- Originated as ATLX app, project is morphing into `DYD` for "Dancey Dance"


